{"initCode":"import requests\nimport os\nimport json\nfrom pyspark.sql.types import StringType, ArrayType, StructField, StructType, IntegerType, DoubleType","code":"@udf(returnType=\n        ArrayType(\n            StructType([\n                StructField(\"entity\", StringType(), True),\n                StructField(\"score\", DoubleType(), True),\n                StructField(\"index\", DoubleType(), True),\n                StructField(\"word\", StringType(), True),\n                StructField(\"start\", IntegerType(), True),\n                StructField(\"end\", IntegerType(), True),\n            ]), \n        True)\n    )\ndef get_model_response_single_with_schema(message:str) -> dict:\n    url = 'https://dbc-19bbe7b0-ce18.cloud.databricks.com/serving-endpoints/test-pii-model/invocations'\n    headers = {'Authorization': f'Bearer {Config.databricks_token}', 'Content-Type': 'application/json'}\n    data_json = json.dumps({'inputs':[message]})\n    response = requests.request(method='POST', headers=headers, url=url, data=data_json)\n    if response.status_code != 200:\n        raise Exception(f'Request failed with status {response.status_code}, {response.text}')\n    return response.json().get('predictions')[0]\n"}